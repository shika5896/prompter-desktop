# Prompter Desktop

テレプロンプター用の原稿編集・表示デスクトップアプリケーション。

## 概要

放送・プレゼンテーション向けのテレプロンプター原稿を編集・表示するためのアプリです。
ハーフミラー対応の左右反転表示、振り仮名（ルビ）、辞書ベースの自動振り仮名、スライドへのキー割り当てによる即時ジャンプなど、実用的な機能を備えています。

## 技術スタック

| レイヤー | 技術 |
|---------|------|
| デスクトップフレームワーク | Tauri 2 |
| バックエンド | Rust |
| フロントエンド | SolidJS + TypeScript |
| ビルドツール | Vite |
| データ形式 | TOML |
| 形態素解析 | Lindera (IPADIC辞書埋め込み) |
| フォント列挙 | font-kit (DirectWrite) |

## 主な機能

- スライド単位での原稿編集（追加・削除・複製・並べ替え）
- フォントサイズ・色のスライドごとの設定
- 振り仮名（ルビ）の手動追加・編集・削除
- **辞書ベースの自動振り仮名**（漢字部分のみ正確にルビを付与）
- テキストファイル（.txt）からのインポート（任意の区切り文字でスライド分割）
- 検索・置換（全スライド横断）
- Undo / Redo
- **表示解像度設定**（仮想キャンバスによるフィットスケーリング、プリセット / カスタム対応）
- フルスクリーン表示 + ハーフミラー反転
- スライドへのキー割り当て（即時ジャンプ）
- ダーク / ライトテーマ
- 日本語 / 英語 UI
- **前回ファイルの自動オープン**（設定でオン/オフ）
- **オートセーブ**（30秒間隔、設定でオン/オフ）
- 未保存変更のウィンドウ閉じ防止

## 画面構成

### 編集画面（ホーム）
- 左サイドバーにスライド一覧（キーボード操作・複製対応）
- ツールバーに原稿タイトル入力 + フォントサイズ・色の変更、振り仮名追加/削除/自動付与、Undo/Redo
- ドロップダウンメニューはマウスホバーで表示
- テキストエディタで直接編集、振り仮名はクリックでダイアログ編集
- プレビューモーダルで表示画面と同じ見た目を確認（仮想キャンバス方式）
- TOML形式での読み込み・保存、テキストインポート

### 表示画面
- フルスクリーン表示（F11キー）
- ハーフミラー対応の左右反転表示
- 仮想キャンバスによるフィットスケーリング（設定解像度に基づく一貫したレイアウト）
- 矢印キー / Page Up・Down / マウスホイールでスライド送り
- 割り当てキーで任意のスライドへ即時ジャンプ

### 設定画面
- 本文フォント（システムフォント一覧から検索・選択・サイズ・色）
- 振り仮名フォント（システムフォント一覧から検索・選択・サイズ・色）
- 言語（日本語 / English）
- テーマ（ダーク / ライト）
- 左右反転（トグルスイッチ）
- 表示解像度（プリセット: 1920×1080, 1280×720, 2560×1440 / カスタム）
- 前回ファイルの自動オープン（トグルスイッチ）
- オートセーブ（トグルスイッチ）

## キーボードショートカット

### 編集画面
| キー | 操作 |
|------|------|
| `Ctrl+S` | 保存 |
| `Ctrl+O` | 開く |
| `Ctrl+N` | 新規作成 |
| `Ctrl+Z` | 元に戻す |
| `Ctrl+Y` | やり直し |
| `Ctrl+F` | 検索 |
| `Ctrl+H` | 置換 |

### 表示画面
| キー | 操作 |
|------|------|
| `→` `↓` `PageDown` | 次のスライド |
| `←` `↑` `PageUp` | 前のスライド |
| `F11` | フルスクリーン切替 |
| `Escape` | メニューに戻る |
| 割り当てキー | 対応スライドへジャンプ |

## 原稿ファイル形式（TOML）

```toml
title = "ニュース原稿"
created = "2026-02-28T10:00:00"

[[slides]]
key_binding = "F1"

[[slides.segments]]
type = "text"
content = "本日のニュースをお伝えします。"

[[slides.segments]]
type = "ruby"
base = "経済"
reading = "けいざい"
```

## 開発環境のセットアップ

### 前提条件

- **Node.js** LTS（v20以上）
- **Rust**（rustup経由）
- **Visual Studio Build Tools 2022**（C++ ビルドツール ワークロード）

### インストール

```bash
# 依存パッケージのインストール
npm install

# 開発サーバーの起動（フロントエンド + Tauriアプリ）
npm run tauri dev
```

### ビルド

```bash
# プロダクションビルド（EXE + インストーラー生成）
npm run tauri build
```

ビルド成果物は `src-tauri/target/release/` に出力されます:
- `prompter-desktop.exe` — スタンドアロン実行ファイル
- `bundle/msi/` — MSIインストーラー
- `bundle/nsis/` — NSISインストーラー

## プロジェクト構成

```
Prompter Desktop/
├── src/                        # フロントエンド（SolidJS + TypeScript）
│   ├── screens/                #   3画面（Edit, Display, Settings）
│   ├── components/             #   UIコンポーネント
│   │   ├── common/             #     汎用（Button, Modal, ToggleSwitch, FontSelect等）
│   │   ├── editor/             #     編集（SlideEditor, RubyDialog等）
│   │   └── display/            #     表示（SlideRenderer, DisplayContainer等）
│   ├── stores/                 #   状態管理（settings, manuscript, display）
│   ├── hooks/                  #   カスタムフック（キー操作, ホイール操作）
│   ├── commands/               #   Tauriコマンドラッパー
│   ├── i18n/                   #   多言語辞書（日本語, English）
│   ├── types/                  #   TypeScript型定義
│   ├── utils/                  #   ユーティリティ（セグメント結合等）
│   └── styles/                 #   CSS（テーマ, 変数, グローバル）
└── src-tauri/                  # バックエンド（Rust）
    └── src/
        ├── commands/           #   Tauriコマンド（TOML読み書き, 自動振り仮名, フォント列挙）
        └── models/             #   データモデル（原稿, 設定）
```

## ライセンス

Private
